<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Tool to allow you to send your duplicati notifications to discord">
    <meta name="author" content="James Lloyd">
    <title>Discord Notifications for Duplicati</title>
    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
    <!-- Custom styles for this template -->
  </head>
  <body>
<div class='container'>
    <header class="d-flex align-items-center pb-3 mb-5 border-bottom">
        <a href="/" class="d-flex align-items-center text-dark text-decoration-none"><span class="fs-4">Duplicati Notifications</span></a>
      </header>
    <script src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
    {% if backups| length > 1 %}
    <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="BackupListButton" data-bs-toggle="dropdown" aria-expanded="false">
          Other Backups
        </button>
        <ul class="dropdown-menu" aria-labelledby="BackupListButton">
        {%for backup in backups %}<li><a class="dropdown-item" href="{{ url_for('chart')}}?name={{backup}}&webhook={{ request.args.get('webhook') }}">{{backup}}</a></li>{% endfor %}
        </ul>
      </div>
    {% endif %}
    <canvas id="ModifiedFiles" width="400" height="100"></canvas>
    <canvas id="SizeOfBackup" width="400" height="100"></canvas>
    <canvas id="TimeTaken" width="400" height="100"></canvas>

    <script type="text/javascript">

        var ctx = document.getElementById('ModifiedFiles').getContext('2d');
        var ModifiedFilesData = {
      "labels":{{when|safe}},
      "datasets": [
        {
          "label": "Modified Files",
          "borderColor": "#1f61f0",
          "backgroundColor": "#1f61f0",
          "fill": false,
          "data": {{modifiedfiles|safe}}
        },
        {
            "label": "Added Files",
            "borderColor": "#8b1ff0",
            "backgroundColor": "#8b1ff0",
            "fill": false,
            "data": {{addedfiles|safe}}
          },
          {
              "label": "Deleted Files",
              "borderColor": "#1ff08b",
              "backgroundColor": "#1ff08b",
              "fill": false,
              "data": {{deletedfiles|safe}}
            }
      ]
    };
        var options = {
      "title": {
        "display": true,
        "text": "{{ request.args.get('name') }}",
        "position": "bottom",
        "fullWidth": true,
        "fontColor": "#aa7942",
        "fontSize": 16
      },
      "legend": {
        "display": true,
        "fullWidth": true,
        "position": "top"
      },
      "scales": {
        "yAxes": [
          {
            "ticks": {
              "beginAtZero": true,
              "display": true
            },
            "gridLines": {
              "display": true,
              "lineWidth": 2,
              "drawOnChartArea": true,
              "drawTicks": true,
              "tickMarkLength": 1,
              "offsetGridLines": true,
              "zeroLineColor": "#942192",
              "color": "#d6d6d6",
              "zeroLineWidth": 2
            },
            "scaleLabel": {
              "display": true,
              "labelString": "No. of Files"
            },
            "display": true
          }
        ],
        "xAxes": {
          "0": {
            "ticks": {
              "display": true,
              "fontSize": 14,
              "fontStyle": "italic"
            },
            "display": true,
            "min": 400,
            "gridLines": {
              "display": true,
              "lineWidth": 2,
              "drawOnChartArea": false,
              "drawTicks": true,
              "tickMarkLength": 12,
              "zeroLineWidth": 2,
              "offsetGridLines": true,
              "color": "#942192",
              "zeroLineColor": "#942192"
            },
            "scaleLabel": {
              "fontSize": 16,
              "display": true,
              "fontStyle": "normal"
            }
          }
        }
      },
      "tooltips": {
        "enabled": true,
        "mode": "label",
        "caretSize": 10,
        "backgroundColor": "#942192"
      }
    };
    
        var ModifiedFiles = new Chart(ctx, {
            type: 'line',
            data: ModifiedFilesData,
            options: options
        });

        var ctx = document.getElementById('SizeOfBackup').getContext('2d');
        var sizedata = {
      "labels": {{when|safe}},
      "datasets": [
        {
          "label": "Total Backup Size (GB)",
          "backgroundColor": "#f7891b",
          "fill": false,
          "data": {{size|safe}},
          "borderColor": "#f7891b",
          "borderWidth": "3"
        }
      ]
    };
        var soptions = {
      "title": {
        "display": true,
        "text": "Total Size of Backup",
        "position": "bottom",
        "fullWidth": true,
        "fontColor": "#aa7942",
        "fontSize": 16
      },
      "legend": {
        "display": false,
        "fullWidth": true,
        "position": "top"
      },
      "scales": {
        "yAxes": [
          {
            "ticks": {
              "beginAtZero": false,
              "display": true
            },
            "gridLines": {
              "display": true,
              "lineWidth": 2,
              "drawOnChartArea": true,
              "drawTicks": true,
              "tickMarkLength": 1,
              "offsetGridLines": true,
              "zeroLineColor": "#942192",
              "color": "#d6d6d6",
              "zeroLineWidth": 2
            },
            "scaleLabel": {
              "display": true,
              "labelString": "Total Size of Backup (GB)"
            },
            "display": true,
            "type": "linear",
            min: 500
          }
        ],
        "xAxes": {
          "0": {
            "ticks": {
              "display": true,
              "fontSize": 14,
              "fontStyle": "italic"
            },
            "display": true,
            "gridLines": {
              "display": true,
              "lineWidth": 2,
              "drawOnChartArea": false,
              "drawTicks": true,
              "tickMarkLength": 12,
              "zeroLineWidth": 2,
              "offsetGridLines": true,
              "color": "#942192",
              "zeroLineColor": "#942192"
            },
            "scaleLabel": {
              "fontSize": 16,
              "display": true,
              "fontStyle": "normal"
            }
          }
        }
      },
      "tooltips": {
        "enabled": true,
        "mode": "label",
        "caretSize": 10,
        "backgroundColor": "#00fa92"
      }
    };
    
        var SizeOfBackup = new Chart(ctx, {
            type: 'line',
            data: sizedata,
            options: soptions
        });


        var ctx = document.getElementById('TimeTaken').getContext('2d');
        var timedata = {
      "labels": {{when|safe}},
      "datasets": [
        {
          "label": "Time taken in seconds",
          "backgroundColor": "#f71b1b",
          "fill": false,
          "data": {{timetaken|safe}},
          "borderColor": "#f71b1b",
          "borderWidth": "3"
        }
      ]
    };
        var soptions = {
      "title": {
        "display": true,
        "text": "Time Taken",
        "position": "bottom",
        "fullWidth": true,
        "fontColor": "#aa7942",
        "fontSize": 16
      },
      "legend": {
        "display": false,
        "fullWidth": true,
        "position": "top"
      },
      "scales": {
        "yAxes": [
          {
            "ticks": {
              "beginAtZero": false,
              "display": true
            },
            "gridLines": {
              "display": true,
              "lineWidth": 2,
              "drawOnChartArea": true,
              "drawTicks": true,
              "tickMarkLength": 1,
              "offsetGridLines": true,
              "zeroLineColor": "#942192",
              "color": "#d6d6d6",
              "zeroLineWidth": 2
            },
            "scaleLabel": {
              "display": true,
              "labelString": "Time Taken (Seconds)"
            },
            "display": true,
            "type": "linear",
            min: 500
          }
        ],
        "xAxes": {
          "0": {
            "ticks": {
              "display": true,
              "fontSize": 14,
              "fontStyle": "italic"
            },
            "display": true,
            "gridLines": {
              "display": true,
              "lineWidth": 2,
              "drawOnChartArea": false,
              "drawTicks": true,
              "tickMarkLength": 12,
              "zeroLineWidth": 2,
              "offsetGridLines": true,
              "color": "#942192",
              "zeroLineColor": "#942192"
            },
            "scaleLabel": {
              "fontSize": 16,
              "display": true,
              "fontStyle": "normal"
            }
          }
        }
      },
      "tooltips": {
        "enabled": true,
        "mode": "label",
        "caretSize": 10,
        "backgroundColor": "#00fa92"
      }
    };
    
        var TimeTaken = new Chart(ctx, {
            type: 'line',
            data: timedata,
            options: soptions
        });
    </script>


</div>
<div class="container">
    <footer class="py-3 my-4">
      <ul class="nav justify-content-center border-top pb-3 mb-3">
        <li class="nav-item"><a href="https://james.lloyd.ws/duplicati-discord-notifications/" class="nav-link px-2 text-muted">James Lloyd</a></li>
        <li class="nav-item"><a href="https://github.com/jameslloyd/duplicati-discord-notification" class="nav-link px-2 text-muted">Github Repo</a></li>
        <li class="nav-item"><a href="https://hub.docker.com/repository/docker/jameslloyd/duplicati-notifications" class="nav-link px-2 text-muted">Docker Hub</a></li>
      </ul>
    </footer>
  </div>
</body>
</html>